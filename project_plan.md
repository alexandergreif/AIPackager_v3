# Project Plan – AIPackager v2 (UI‑first, TDD, KISS)

**Document ID:** project_plan.md
**Last updated:** 2025‑06‑21

---

## 1  Purpose & Vision
Deliver a lean **web application** that lets a packaging admin upload a Windows installer (MSI/EXE) and instantly receive a production‑ready **PowerShell App Deployment Toolkit** script, generated by GPT‑4o, with full metadata injected.
Guiding principles: **KISS**, **Test‑Driven Development**, and quick visual feedback (UI first).

## 2  Objectives & KPIs

| ID | Objective | Key Metric |
|----|-----------|-----------|
| O1 | Instant visual workflow (Upload → Progress → Detail) | Demo works live in first sprint |
| O2 | Reliable file handling & metadata extraction | ≥ 95 % of tested MSIs parsed correctly |
| O3 | Deterministic PSADT template rendering | All generated scripts pass compliance linter |
| O4 | Quality gates in CI | Ruff, mypy, pytest green on every PR |
| O5 | Job resilience | Interrupted jobs auto‑resume on restart |

## 3  Project Phases / Sprints

| Phase | Theme | Outcome |
|-------|-------|---------|
| 0 | **Repo & Tooling** | Git, pip‑tools locks, pre‑commit, GitHub Actions |
| 1 | **UI Skeleton** | Upload page, progress bar, sidebar, history list |
| 2 | **Backend Core** | File persistence, DB models, metadata extractor, CMTrace logging |
| 3 | **Template & Prompt** | Jinja PSADT template, prompt templates folder, no AI yet |
| 4 | **AI Integration** | GPT‑4o function‑call, PSADT JSON schema, script renderer |
| 5 | **Polish & Resume** | Job‑resume, copy‑to‑clipboard, guardrails, perf tests |

Each phase maps 1‑week sprints; see individual `sprint<N>.md` files for granular tickets.

## 4  In Scope / Out of Scope

*In‑scope*: Flask backend, SQLite via SQLAlchemy, Tailwind/Alpine front‑end, LessMSI & PE header analysis, OpenAI GPT‑4o, GitHub Actions.

*Out‑of‑scope*: Multi‑tenant auth, non‑SQLite DBs, enterprise RBAC, complex RAG systems.

## 5  High‑Level Architecture

```
aipackager/
├─ app/                 # Flask blueprints & factory
├─ services/            # Business logic & agents
├─ templates/           # HTML + Jinja PSADT & prompt templates
├─ static/              # Tailwind CSS build
├─ uploads/             # Saved installer files (instance‑relative)
├─ tests/               # Pytest suites
└─ ci/                  # GitHub Actions workflows
```

## 6  Risk Register

| Risk | Mitigation |
|------|------------|
| LLM hallucinations | Structured JSON schema + compliance tests |
| LessMSI missing on Linux | Container with Wine or fallback metadata path |
| File upload exploits | `secure_filename`, size limit 200 MB |
| Dead jobs on crash | Phase 5 auto‑resume logic |

## 7  Timeline (6 weeks)

`Week 1` Phase 0 · `Week 2` Phase 1 · `Week 3` Phase 2 · `Week 4` Phase 3 · `Week 5` Phase 4 · `Week 6` Phase 5

---

**Approval criteria**: All KPIs hit, coverage ≥ 85 %, demo passes end‑to‑end with sample MSI & EXE.
